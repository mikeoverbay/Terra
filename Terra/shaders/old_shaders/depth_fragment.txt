// writes to depth texture.
// This is not used yet.
// Im experimenting with pre-bluring the shadow map.
varying vec4 v_position;

void main()
{
	
	float d = v_position.z / v_position.w ;

	d = d* 0.5 + 0.5;
	
	float d2 = d * d;

	// Adjusting moments (this is sort of bias per pixel) using derivative
	float dx = dFdx(d);
	float dy = dFdy(d);
	d2 += 0.25*(dx*dx+dy*dy) ;	

	gl_FragColor = vec4( d,d2, 0.0, 1.0 );

}